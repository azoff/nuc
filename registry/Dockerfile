FROM registry:2

ENV REGISTRY_AUTH htpasswd
ENV REGISTRY_AUTH_HTPASSWD_REALM Registry Realm

ARG REGISTRY_HTTP_SECRET=s3cr3t
ENV REGISTRY_HTTP_SECRET=$REGISTRY_HTTP_SECRET

ARG REGISTRY_USER
ARG REGISTRY_PASSWORD
ENV REGISTRY_AUTH_HTPASSWD_PATH /etc/registry/htpasswd

RUN mkdir /etc/registry/ && \
	htpasswd -Bbn $REGISTRY_USER $REGISTRY_PASSWORD >> /etc/registry/htpasswd
